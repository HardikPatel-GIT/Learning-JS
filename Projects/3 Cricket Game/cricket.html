<!DOCTYPE html>
<html lang="en">

<head>
    <title>Cricket Game</title>
    <style>
        body {
            text-align: center;
        }
    </style>
</head>

<body>
    <h1>Bat Ball Stump Game</h1>

    <button onclick="
        let computerChoice = generatecomputerMove();
        let resultMsg = getResult('Bat', computerChoice);
        showResult('Bat',computerChoice, resultMsg);
    ">Bat</button>

    <button onclick="
        computerChoice = generatecomputerMove();
        resultMsg = getResult('Ball', computerChoice);
        showResult('Ball', computerChoice, resultMsg);
    ">Ball</button>

    <button onclick="
        computerChoice = generatecomputerMove();
        resultMsg = getResult('Stump', computerChoice);
        showResult('Stump', computerChoice, resultMsg);
    ">Stump</button>
    
    <button onclick="localStorage.clear()
    resetScore()">Reset</button>

    <script>
        let scoreStr = localStorage.getItem('Score');
        let score;
        resetScore(scoreStr);
        

        function resetScore(scoreStr){
            score = scoreStr ? JSON.parse(scoreStr) : {
            win : 0,
            lost : 0,
            tie : 0,        
            };
        }
        // if (scoreStr !== undefined){
        //     score = JSON.parse(scoreStr);
        //     }
        // else{
        //     score = {
        //         win : 0,
        //         lost : 0,
        //         tie : 0,        
        //     };
        // }

        score.displayScore = function(){
                return `No of matches Won: ${score.win} , Lost: ${score.lost} , Tie: ${score.tie}`
            };

        function generatecomputerMove() {
            //Generate random number between 0 and 3
            let randomNumber = Math.random() * 3;

            if (randomNumber <= 1) {
                return 'Bat';
            } else if (randomNumber <= 2) {
                return 'Ball';
            } else {
                return 'Stump';
            }
        }

        function getResult(userMove, computerMove){
            if (userMove === 'Bat'){
                if (computerMove === 'Ball'){
                    score.win = score.win + 1;
                    return 'User Won.';
                }else if(computerMove === 'Bat'){
                    score.tie = score.tie + 1;
                    return 'It is a tie';
                }else if(computerMove === 'Stump'){
                    score.lost = score.lost + 1;
                    return 'Computer has won';
                }
            }
            else if (userMove ==="Ball"){
                if (computerMove === 'Stump'){
                    score.win += 1;
                    return 'User Won.';
                }else if(computerMove === 'Ball'){
                    score.tie += 1;
                    return 'It is a tie';
                }else if(computerMove === 'Bat'){
                    score.lost += 1;
                    return 'Computer has won';
                }
            }
            else{
                if (computerMove === 'Bat'){
                    score.win++;
                    return 'User Won.';
                }else if(computerMove === 'Stump'){
                    score.tie++;
                    return 'It is a tie';
                }else if(computerMove === 'Ball'){
                    score.lost++;
                    return 'Computer has won';
            }

            }

        }
        function showResult(userMove, computerMove, resultMsg){
            localStorage.setItem('Score', JSON.stringify(score));

            alert(`
            You have chosen ${userMove}.  Computer choice is ${computerMove}
            
            ${resultMsg}
            
            ${score.displayScore()}
            `);
            
        }

    </script>

</body>

</html>